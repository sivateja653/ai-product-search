{
  "family": "search-service",
  "revision": 10,
  "networkMode": "awsvpc",
  "requiresCompatibilities": [
    "FARGATE"
  ],
  "cpu": "512",
  "memory": "1024",
  "taskRoleArn": "arn:aws:iam::068571370361:role/search-service-task-role",
  "executionRoleArn": "arn:aws:iam::068571370361:role/ecsTaskExecutionRole",
  "container": {
    "name": "search-service",
    "image": "068571370361.dkr.ecr.us-east-1.amazonaws.com/search-service:v1.0.2",
    "essential": true,
    "portMappings": [
      {
        "containerPort": 8080,
        "hostPort": 8080,
        "protocol": "tcp",
        "name": "search-service-8080-tcp",
        "appProtocol": "http"
      }
    ],
    "environment": [
      {
        "name": "SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE",
        "value": "10"
      },
      {
        "name": "SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE",
        "value": "5"
      },
      {
        "name": "LOGGING_LEVEL_ORG_SPRINGFRAMEWORK",
        "value": "INFO"
      },
      {
        "name": "LOGGING_LEVEL_COM.AIPRODUCTSEARCH",
        "value": "DEBUG"
      },
      {
        "name": "SPRING_PROFILES_ACTIVE",
        "value": "prod,enterprise"
      }
    ],
    "secrets": [
      {
        "name": "DB_HOST",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:DB_HOST::"
      },
      {
        "name": "DB_NAME",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:DB_NAME::"
      },
      {
        "name": "DB_PASS",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:DB_PASS::"
      },
      {
        "name": "DB_PORT",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:DB_PORT::"
      },
      {
        "name": "DB_USER",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:DB_USER::"
      },
      {
        "name": "JWK_SET_URI",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:JWK_SET_URI::"
      },
      {
        "name": "JWT_ISSUER",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:JWT_ISSUER::"
      },
      {
        "name": "OPENAI_API_KEY",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:068571370361:secret:search-service-prod-W4wqgN:OPENAI_API_KEY::"
      }
    ],
    "command": null,
    "entryPoint": null,
    "dependsOn": null,
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/search-service",
        "awslogs-region": "us-east-1",
        "awslogs-stream-prefix": "ecs"
      },
      "secretOptions": []
    },
    "healthCheck": {
      "command": [
        "wget -qO- http://localhost:8080/actuator/health | grep -q '\"status\":\"UP\"' || exit 1"
      ],
      "interval": 30,
      "timeout": 5,
      "retries": 5,
      "startPeriod": 120
    }
  }
}
